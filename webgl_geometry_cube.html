<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>My first three.js app</title>
		<style>
			body { margin: 0; }
		</style>
	</head>
	<body>
		<script src="build/three.min.js"></script>
		<script src="https://cdn.rawgit.com/mrdoob/three.js/master/examples/js/loaders/GLTFLoader.js"></script>

		<script type="module">

		import { MapControls } from "https://threejs.org/examples/jsm/controls/OrbitControls.js";

			let scene,camera,renderer,controls,light;
			
			const init = function () {
				scene = new THREE.Scene();
				scene.background = new THREE.Color(0xdddddd);
				const color = 0xFFFFFF;  // white
				const near = 10;
				const far = (500);
				scene.fog = new THREE.Fog(color, near, far);

				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.setPixelRatio(window.devicePixelRatio)
				document.body.appendChild( renderer.domElement );

				camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 1000 );
				camera.position.set( 200, 100, 0 );

				// controls

				controls = new MapControls( camera, renderer.domElement );

				//controls.addEventListener( 'change', render ); // call this only in static scenes (i.e., if there is no animation loop)

				controls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled
				controls.dampingFactor = 0.05;

				controls.screenSpacePanning = false;

				controls.minDistance = 10;
				controls.maxDistance = 1000;

				controls.maxPolarAngle = Math.PI / 2;

				

				light = new THREE.DirectionalLight(0x9a9a9a, 1)
				light.position.set(-300, 750, -300)
				light.castShadow = true
				light.shadow.mapSize.width = light.shadow.mapSize.height = 4096
				light.shadow.camera.near = 1
				light.shadow.camera.far = 1000
				light.shadow.camera.left = light.shadow.camera.bottom = -200
				light.shadow.camera.right = light.shadow.camera.top = 200
				scene.add(light)
				scene.add(new THREE.HemisphereLight(0xefefef, 0xffffff, 1))
	
				const axesHelper = new THREE.AxesHelper( 5 );
				scene.add( axesHelper );

				let loader = new THREE.GLTFLoader();
				loader.load('3d/TestBlender/road/roadTexture.glb', function(gltf){
					let car = gltf.scene.children[0];
					//gltf.scene.rotation.x = Math.PI/2;
					gltf.scene.scale.set(1, 1, 1)
					scene.add(gltf.scene);
					animate();
				});
			}


			const animate = function () {
				requestAnimationFrame( animate );
				controls.update();
				renderer.render( scene, camera );
			};

			init();
			//animate();
		</script>
	</body>
</html>